<h1>Home</h1>

<% if !current_user %>
    <div id="signin-signup">
        <%= form_tag("/signin", method: "get") do %>
            <p class="signin-group"><%= text_field_tag :username, value = "teb" %><%= label_tag(:username, "username") %></p>
            <p class="signin-group"><%= text_field_tag :password, value = "teb123" %><%= label_tag(:password, "password") %></p>
            <%= submit_tag "Login" %>
        <% end %>
    </div>

<% else %>
    <% puts " ** current_user.inspect: #{current_user.inspect}" %>

    <% @users.each_with_index do |user, index| %>
        <% user_post = @postsArray[index].first %>
        <% puts " ** user_post.inspect: #{user_post.inspect}" %>

        <!-- ======= ======= user ======= ======= -->
        <div class="user-box">

            <!-- ======= ======= tags ======= ======= -->
            <% if user_post != "n" %>
                <% post_tags = user_post.tags %>
                <% puts " ** post_tags.inspect: #{post_tags.inspect}" %>
                <% puts " ** post_tags.length: #{post_tags.length}" %>
                <% if post_tags.length > 0 %>
                    <p class="tag-group">

                        <% post_tags.each_with_index do |tag, index| %>
                            <% if index < post_tags.length - 1 %>
                                <% if current_user %>
                                    <%= link_to tag.tag_name, "/toggle_tag?user=#{current_user.id}&tag=#{tag.id}" %> |
                                <% else %>
                                    <%= tag.tag_name %> |
                                <% end %>
                            <% else %>
                                <% if current_user %>
                                    <%= link_to tag.tag_name, "/toggle_tag?user=#{current_user.id}&tag=#{tag.id}" %>
                                <% else %>
                                    <%= tag.tag_name %>
                                <% end %>
                            <% end %>
                        <% end %>

                    </p>
                <% else %>
                    <% puts " ** NO TAGS ** " %>
                    <p class="tag-group">no tags for this post</p>
                <% end %>
            <% end %>

            <div class="title-box">
                <div class="name-link">
                    <%= link_to user.fname + " " + user.lname, user_posts_path(user) %>
                </div>
                <div class="post-title">
                    <% if user_post != "n" %>
                        <%= user_post.title %>
                    <% else %>
                        <p class="empty-text">no posts for this user</p>
                    <% end %>
                </div>
                <div class="user-links">
                    <%= link_to "profile", user_path(user) %>
                </div>
            </div>

            <!-- ======= ======= first post ======= ======= -->
            <div class="post-content">
                <% if user_post != "n" %>
                    <%= user_post.content %>
                <% end %>
            </div>

        </div>
    <% end %>
    <br>
    <%= link_to "Back", request.referer.present? ? request.referer : "/home" %>

<% end %>

<script>
$('.')

</script>
