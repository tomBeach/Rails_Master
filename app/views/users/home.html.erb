<h1>Home</h1>

<%# if !session[:user_id]%>
<% if !current_user %>
    <div id="signin-signup">
        <%= form_tag("/signin", method: "get") do %>
            <p class="signin-group"><%= text_field_tag :username, value = "teb" %><%= label_tag(:username, "username") %></p>
            <p class="signin-group"><%= text_field_tag :password, value = "teb123" %><%= label_tag(:password, "password") %></p>
            <%= submit_tag "Login" %>
        <% end %>
    </div>

<% else %>

    <% @users.each_with_index do |user, index| %>
        <% user_post = @postsArray[index].first %>
        <% puts " ** user_post.inspect: #{user_post.inspect}" %>

        <!-- ======= ======= tags ======= ======= -->
        <% if user_post != "n" %>
            <% post_tags = user_post.tags %>
            <% if post_tags %>
                <% puts " ** post_tags.inspect: #{post_tags.inspect}" %>
                <p class="empty-text"> | 
                <% post_tags.each do |tag| %>
                    <%= tag.tag_name %> |
                <% end %>
                </p>
            <% else %>
                <% puts " ** NO TAGS ** " %>
                <p class="empty-text">no tags for this post</p>
            <% end %>
        <% end %>


        <!-- ======= ======= user ======= ======= -->
        <div class="user-box">
            <div class="title-box">
                <div class="name-link">
                    <%= link_to user.fname + " " + user.lname, user_posts_path(user) %>
                </div>
                <div class="post-title">
                    <% if user_post != "n" %>
                        <%= user_post.title %>
                    <% else %>
                        <p class="empty-text">no posts for this user</p>
                    <% end %>
                </div>
                <div class="user-links">
                    <%= link_to "profile", user_path(user) %>
                </div>
            </div>

            <!-- ======= ======= first post ======= ======= -->
            <div class="post-content">
                <% if user_post != "n" %>
                    <%= user_post.content %>
                <% end %>
            </div>

        </div>
    <% end %>
    <br>
    <%= link_to "Back", request.referer.present? ? request.referer : "/home" %> |
    <%= link_to 'New User', new_user_path %>

<% end %>
